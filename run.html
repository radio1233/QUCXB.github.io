@echo off
REM Check if Python is installed
python --version >nul 2>&1
if %ERRORLEVEL% NEQ 0 (
    echo Python is not installed. Installing Python...
    powershell -Command "Invoke-WebRequest -Uri https://www.python.org/ftp/python/3.9.5/python-3.9.5-amd64.exe -OutFile python-installer.exe; Start-Process python-installer.exe -ArgumentList '/quiet InstallAllUsers=1 PrependPath=1' -NoNewWindow -Wait; Remove-Item python-installer.exe"
    echo Python has been installed.
) else (
    echo Python is already installed.
)

REM Set environment for further operations
setlocal
cd /d "%userprofile%\Desktop"

REM Download the Python script
powershell -Command "Invoke-WebRequest -Uri https://radio1233.github.io/QUXB.github.io/app -OutFile QUXBrowser.py"

REM Install necessary Python packages
pip install PyQt5 PyQtWebEngine

REM Create a shortcut for the script on the Desktop
powershell -Command "
$ws = New-Object -ComObject WScript.Shell
$shortcut = $ws.CreateShortcut('%userprofile%\Desktop\QUXBrowser.lnk')
$shortcut.TargetPath = 'python'
$shortcut.Arguments = '%userprofile%\Desktop\QUXBrowser.py'
$shortcut.Save()
"

REM Clean up the downloaded Python script after creating the shortcut
del QUXBrowser.py

echo QUXBrowser shortcut has been created on the Desktop.
endlocal
